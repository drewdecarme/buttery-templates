#! /usr/bin/env node
import { program } from "commander";
import { glob } from "glob";
import type { CLIConfig } from "../types/index.js";
import { registerCommandsFromFiles } from "./util.process-command-dir.js";
import { fileURLToPath, resolve } from "node:url";
import path from "path";

import("./{{cli_name}}.config.js").then(async ({ default: config }) => {
  // Add the name and the description of the CLI
  program.name(config.name).description(config.description);

  const commandFilePaths = glob.sync(path.resolve(config.root, "./commands/**.js"), {
    follow: false,
  });
  
  await registerCommandsFromFiles(program, commandFilePaths);
  await program.parseAsync();
}).catch(error => {
  console.error(error);
  throw new Error(error);
})


